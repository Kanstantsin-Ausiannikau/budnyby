/*!
 * StyleWizard
 * www.easydnnsolutions.com/modules/easydnnstylewizard/
 *
 * Copyright 2013 EasyDNNsolutions.com
 * StyleWizard is developed by EasyDNNsolutions.com. It can be used only
 * as an integral part of EasyDNNsolutions.com modules. All unauthorized
 * copying or use of the code or parts of the code is prohibited.
 */

(function(b,aa,ba,s){var ca=!1,p={},t={},m={},X=[],Y=!1,x,F,E=function(b){return F.localization[b]==s?b:F.localization[b]},L=function(b,c){var f=function(b){c&&c(t.css.generateColorText(b))};return{color:b,showInput:!0,allowEmpty:!0,showAlpha:!0,showPalette:!1,showInitial:!0,preferredFormat:"hex",change:f,move:f,hide:f,className:"styleWizardPicker",chooseText:"OK",cancelText:"Cancel",clickoutFiresChange:!0}},da=0,R=0,ea=0,fa=0,ga=0,S=0,T=0,Z=0,B=-1,C=[],U=!0,G=[],M={},N=[],ka=b(aa),D,H,ha,V,J,z,O,
A,P;p.resize=function(){da=D.height();S=z.width();p.innerResize()};p.innerResize=function(){var a=B,a=b("> .subject_"+a+"_"+C[a],z);ga=J.is(":visible")?J.outerHeight(!0):0;ea=ha.outerHeight(!0);fa=V.outerHeight(!0);T=da-ga-ea-fa;z.height(T);O.is(":visible")&&O.height(T).tinyscrollbar_update("relative");0<a.length&&(b("> .slider > .styleSelection",a).tinyscrollbar_update("relative"),0==Z&&(Z=b("> .slider > .styleEditor > .header",a).outerHeight(!0)),b("> .slider > .styleEditor > .editor",a).height(T-
Z).tinyscrollbar_update("relative"))};p.openActiveCollection=function(){var a=B,c=x[a].subjects,f="";O.css("display","none");z.css("display","block");1<c.length?(b.each(c,function(b,a){f+="<option>"+t.html.encode(a.name)+"</option>"}),c=J.css("display","block").find("> select").html(f),c[0].selectedIndex=C[a]):J.css("display","none");b("> li",A).removeClass("active").eq(a).addClass("active");p.openActiveSubject()};p.openActiveSubject=function(){var a=B,c=C[a],f=x[a].subjects[c],d=b("> .subject_"+
a+"_"+c,z),f=f.activeStyle.type;0==d.length&&(p.initSubjectLayout(a,c),d=b("> .subject_"+a+"_"+c,z));a=b("> .slider",d);a=b(".styleSelection",a);a=b("> .viewport > .overview",a);b("> .styleTypes >",a).css("display","none").filter("."+f).css("display","block");b("> .styleTypeSelection >",a).removeClass("active").filter("."+f).addClass("active");b("> .styleTypes > div > ol > li",a).removeClass("actionsOverlayActive");b(">",z).css("display","none");d.css("display","block");p.innerResize()};p.initSubjectLayout=
function(a,c){var f=x[a],d=f.subjects[c],f=f.styleGroups[d.styleGroup],e="",k=b('<div class="subject_'+a+"_"+c+'"><div class="slider"><div class="styleSelection standardScrollbar"><div class="viewport"><div class="overview"></div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div><div class="styleEditor"><div class="header"><div class="back"><span class="icon"></span><span class="text">Back to style selection</span></div><div class="styleName"><label><span>Style name:</span><input type="text" name="styleName" value="" /></label></div></div><div class="editor standardScrollbar"><div class="viewport"><div class="overview"><div class="styleEditorSpacer"></div></div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div></div></div></div>'),
e=b("> .slider",k),h=b("> .styleSelection",e),g=b("> .viewport > .overview",h),m,w,n=b("> .styleEditor",e),n=b("> .editor",n),q=!1;d.initialActiveStyle=b.extend({},d.activeStyle);e.width(2*S);b(">",e).width(S);e='<ul class="styleTypeSelection"><li class="predefined"><span>'+E("Predefined")+'</span></li><li class="custom"><span>'+E("Custom")+'</span></li></ul><div class="styleTypes"><div class="predefined" style="display: none;"><ol></ol></div><div class="custom" style="display: none;"><ol></ol></div></div>';
g.html(e);m=b("> .styleTypes > .predefined > ol",g);b.each(f.styles.predefined,function(a,c){var f=t.style.getNameAndColors(c,d.templateGroup);c.show!=s&&-1==b.inArray(d.templateGroup,c.show)||m.append(p.generateStyleListItem({name:f.name,type:"predefined",colors:f.colors,active:"predefined"==d.activeStyle.type&&d.activeStyle.id==a,id:a}))});b.isEmptyObject(f.styles.custom)||(w=b("> .styleTypes > .custom > ol",g),b.each(f.styles.custom,function(a,c){var f=t.style.getNameAndColors(c,d.templateGroup);
c.show&&-1==b.inArray(d.templateGroup,c.show)||(q=!0,w.append(p.generateStyleListItem({name:f.name,type:"custom",colors:f.colors,active:"custom"==d.activeStyle.type&&d.activeStyle.id==a,id:a})))}));q||b("> .styleTypeSelection > .custom",g).css("display","none");k.data("subjectIndex",c).appendTo(z);h.tinyscrollbar();n.tinyscrollbar()};p.generateStyleListItem=function(a){var c="custom"==a.type,c=b('<li class="'+(a.active?"active":"")+(c?" "+a.id:" predefined_"+a.id)+'"><ol class="colorPreview"></ol><span>'+
t.html.encode(a.name)+'</span><div class="overlayWrapper"><div class="actionsOverlay"><div class="action edit" title="'+E("Edit style")+'"><span>'+E("Edit style")+"</span></div>"+(c?'<div class="action delete" title="'+E("Delete style")+'"><span>'+E("Delete style")+"</span></div>":"")+'<div class="action close" title="'+E("Close actions")+'"><span>'+E("Close actions")+'</span></div></div><div class="standardOverlay"><div class="openActionsOverlay" title="'+E("Open actions")+'"><span>'+E("Open actions")+
"</span></div></div></div></li>"),f=b("> .colorPreview",c);a.colors!=s&&0<a.colors.length&&b.each(a.colors,function(a,c){f.prepend(b("<li></li>").css("background",c))});return c.data("styleId",a.id)};p.cloneStyle=function(a){var c=x[a.collection],c=c.styleGroups[c.subjects[a.subject].styleGroup].styles,f=c[a.type][a.id],d={},e,k;c.custom==s&&(c.custom={});do e="s"+t.string.random(10).toLowerCase();while(c.custom[e]!=s);b.extend(!0,d,f);for(k in d.templateGroups)d.templateGroups[k].name+=" Copy";d.originalStyleId=
"predefined"==a.type?a.id:f.originalStyleId;d.baseCss="";c.custom[e]=d;return e};p.setupStyleEditor=function(){var a=B,c=C[a],f=x[a],d=f.subjects[c],e=f.styleGroups[d.styleGroup],k=e.styles.custom[d.activeStyle.id],h=t.style.getNameAndColors(k,d.templateGroup),g=e.styles.predefined[k.originalStyleId].baseCss,a=b("> .subject_"+a+"_"+c,z),l=b("> > .styleEditor",a),a=b("> .header",l),l=b("> .editor > .viewport > .overview > .styleEditorSpacer",l);k!=s&&("string"!=typeof g&&(g=""),0<G.length&&(b.each(G,
function(b,a){a.spectrum("destroy")}),G=[]),m.changeSectionStyle({collectionType:f.type,styleSwitchCriteria:d.styleSwitchCriteria,styleGroup:d.styleGroup,globalFontFamilies:e.customFontFamilies,template:d.template,templateGroup:d.templateGroup,themeName:e.themeName,assetsRootPath:e.styleAssetsClientRoot,style:{type:"custom",id:d.activeStyle.id,definition:e.styleDefinitions,values:k.values,baseCss:g}}),b("> .styleName input",a).val(h.name),l.html(""),p.generateStyleEditorElements(l,f.styleGroups[d.styleGroup].styleDefinitions,
k.values,d.templateGroup,d.subCollection,"styleWizardEditor_"+f.type+"_"+c+"_"+d.activeStyle.id,"",e.customFontFamilies))};p.generateStyleEditorElements=function(a,c,f,d,e,k,h,g){var l,w;c.properties&&f.properties&&(l=b('<ul class="properties mainCollapsibleBoxes" />').appendTo(a),b.each(c.properties,function(a,c){var w,r=c.type,v;"string"==typeof e&&""!=e&&"string"==typeof c.subCollection&&""!=c.subCollection&&c.subCollection!=e||f.properties[a]==s||c.show&&-1==b.inArray(d,c.show)||!b.isArray(c.show)&&
c.hide&&-1!=b.inArray(d,c.hide)||(w=b('<li class="'+r+'"><div class="toggleContainer"><div class="name property"></div><div class="descendantIndicator"></div></div><div class="toggleContent">'+(1<c.states.length?"<ol></ol>":"")+'<div class="propertyStatesWrapper"></div><div class="descendantIndicator property"></div></div></li>').appendTo(l),b("> .toggleContainer > .name",w).text(c.name),v=b("> .toggleContent",w).css("display","none"),w.data("propertyInitializer",function(){var d="";b.each(c.states,
function(e,v){var l=b("<div />"),y={};l.addClass(r).appendTo(b("> .toggleContent > .propertyStatesWrapper",w));1<c.states.length&&(d+="<li"+("default"==v.id?' class="active"':"")+"><span>"+t.html.encode(v.name)+"</span></li>");"text"==r&&(y={customFonts:b.isArray(g)&&0<g.length?g:[]});m.generatePropertyEditorHtml(l,r,v.forbidden,f.properties[a],v.id,k+"_"+a+"_"+e,h+a,y);m.propertyStateSubsectionDropdown(l,r,v.forbidden,f.properties[a][v.id]);"default"!=v.id&&l.css("display","none")});b("> ol",v).html(d)}))}));
c.sections&&f.sections&&(w=b('<ul class="sections mainCollapsibleBoxes" />').appendTo(a),b.each(c.sections,function(a,c){var m,l;f.sections[a]==s||c.show&&-1==b.inArray(d,c.show)||!b.isArray(c.show)&&c.hide&&-1!=b.inArray(d,c.hide)||(m=b('<li><div class="toggleContainer"><div class="name"></div><div class="descendantIndicator"></div></div><div class="toggleContent"></div></li>').appendTo(w),l=b("> .toggleContent",m),b("> .toggleContainer > .name",m).text(c.name),p.generateStyleEditorElements(l,c,
f.sections[a],d,e,k+"_"+a,h+a+"_",g),0<b("> .properties >",l).length||0<b("> .sections >",l).length?l.css("display","none"):m.remove())}))};p.toggleInterface=function(b,c){var f,d,e;b?(U=!1,H.html("<span />Hide"),f=0,e=R-1,d=R):(U=!0,H.html("<span />StyleWizard"),f=-R,e=0,d=-A.outerHeight());c?(H.stop(!0).animate({left:e},100),D.stop(!0).animate({left:f},100),A.stop(!0).animate({left:d},100)):(H.stop(!0).css({left:e}),D.stop(!0).css({left:f}),A.stop(!0).css({left:d}))};m.changeSectionStyle=function(a){var c;
c="";var f="eds_"+a.collectionType+"_"+a.styleGroup,d=".eds_style_"+a.style.type+"_"+a.style.id,e=t.style.replaceCssTokens(a.style.baseCss,d,a.themeName,a.assetsRootPath),k={themeName:a.themeName,styleType:a.style.type,styleId:a.style.id};if("skin"!=a.collectionType){c=".eds_"+a.collectionType+"_"+a.themeName+".eds_template_"+a.template;a.styleSwitchCriteria&&(c+=".eds_styleSwitchCriteria_"+a.styleSwitchCriteria);c=b(c);t.css.removeClassContaining(c,"eds_style_");if("predefined"==a.style.type&&"default"==
a.style.id)return;f+="_"+a.style.type+"_"+a.style.id;c.addClass("eds_style_"+a.style.type+"_"+a.style.id);c=".eds_"+a.collectionType+"_"+a.themeName+d}m.updateStyleTag(f,e+m.generateStyleCss(a.style.definition,a.style.values,c,a.assetsRootPath,k,a.globalFontFamilies))};m.updateActiveSubjectStyle=function(){var b=B,c=x[b],f=c.subjects[C[b]],b=c.styleGroups[f.styleGroup],c=c.type,d=f.activeStyle.type,e=f.activeStyle.id,f="eds_"+c+"_"+f.styleGroup,k="",h=b.styles[d][e],g="",l=".eds_style_"+d+"_"+e,w=
{themeName:b.themeName,styleType:d,styleId:e};"skin"!=c&&(f+="_"+d+"_"+e,k=".eds_"+c+"_"+b.themeName+l);g="predefined"==d?h.baseCss:b.styles.predefined[h.originalStyleId].baseCss;"string"!=typeof g&&(g="");g=t.style.replaceCssTokens(g,l,b.themeName,b.styleAssetsClientRoot);m.updateStyleTag(f,g+m.generateStyleCss(b.styleDefinitions,h.values,k,b.styleAssetsClientRoot,w,b.customFontFamilies))};m.updateStyleTag=function(a,c){m.updateCssImports();b("head > style#"+a).remove();$tag=b('<style type="text/css" />').html(c).attr("id",
a).appendTo("head")};m.addCssImport=function(a){-1===b.inArray(a,X)&&(X.push(a),Y=!0)};m.updateCssImports=function(){var a=b("head > style#styleWizardCssImports"),c="";Y&&(Y=!1,b.each(X,function(b,a){c+="@import url("+a+");"}),""!=c&&(a.remove(),a=b('<style type="text/css" id="styleWizardCssImports" />').appendTo("head"),a.html(c)))};m.generateStyleCss=function(a,c,f,d,e,k){var h="",g={};"object"==typeof a.properties&&c.properties&&(b.each(a.properties,function(a,h){var n=c.properties[a],q="";n!=
s&&(h.subCollection&&(q=".eds_subCollection_"+h.subCollection),b.each(h.states,function(a,c){var v=m.generateCssFromProperty(h.type,n[c.id],c.forbidden,c.important,d,k),l="";b.isArray(c.selectors)&&0!=c.selectors.length&&(b.each(c.selectors,function(a,c){var d=("custom"==e.styleType?"custom_":"")+e.styleId;"!"==c[0]?(c=c.substr(1).replace(/_-ThemeName-_/g,e.themeName).replace(/_-StyleTypeAndId-_/g,d),l+=c+","):f&&b.isArray(h.show)?b.each(h.show,function(b,a){l+=f+q+".eds_templateGroup_"+a+c+","}):
l+=f+q+c+","}),l=l.substring(0,l.length-1),g[l]==s&&(g[l]=""),g[l]+=v)}))}),b.each(g,function(b,a){h+=b+"{"+a+"}"}));"object"==typeof a.sections&&c.sections&&b.each(a.sections,function(b,a){var g=c.sections[b];g!=s&&(h+=m.generateStyleCss(a,g,f,d,e,k))});return h};m.listStylesThatUseBackgroundImage=function(a,c,f){var d=B,e=x[d],d=e.styleGroups[e.subjects[C[d]].styleGroup].styles,k={predefined:{},custom:{}};if("string"==typeof f){if(""==f)return{};f=f.split("_")}if(0==f.length)return{};"predefined"==
c&&d[c]&&b.each(d[c],function(d,e){b.each(m.getStyleProperty(e.values,b.extend([],f)),function(b,f){if("object"==typeof f.values.image&&f.values.image.type==c&&f.values.image.file==a)return k[c][d]=e,!1})});b.each(d.custom,function(c,d){b.each(m.getStyleProperty(d.values,b.extend([],f)),function(b,f){if("object"==typeof f.values.image&&"uploaded"==f.values.image.type&&f.values.image.file==a)return k.custom[c]=d,!1})});return k};m.getStyleProperty=function(b,c){var f;if(1==c.length)return b.properties[c[0]];
f=c[0];c=c.splice(c.length-(c.length-1));return b.sections==s||b.sections[f]==s?s:m.getStyleProperty(b.sections[f],c)};m.generateCssFromProperty=function(a,c,f,d,e,k){a=m.generateCssFromProperty[a];if(a==s)return"";b.isArray(f)||(f=[]);b.isArray(c.disabled)&&(f=f.concat(c.disabled));return a(c.values,f,d,e,k)};m.generateCssFromProperty.background=function(a,c,f,d){var e="";-1===b.inArray("color",c)&&(e="background-color:"+a.color,-1<b.inArray("color",f)&&(e+="!important"),e+=";");-1===b.inArray("image",
c)&&(e+="background-image:",e="object"!=typeof a.image||"string"!=typeof a.image.completeUrl||""==a.image.completeUrl?e+"none":e+('url("'+a.image.completeUrl.replace(/_-StyleAssetsClientRoot-_/g,d)+'")'),-1<b.inArray("image",f)&&(e+="!important"),e+=";");-1===b.inArray("repeat",c)&&(e+="background-repeat:",e="string"!=typeof a.repeat||""==a.repeat?e+"repeat":e+a.repeat,-1<b.inArray("repeat",f)&&(e+="!important"),e+=";");-1===b.inArray("attachment",c)&&(e+="background-attachment:",e="string"!=typeof a.attachment||
""==a.attachment?e+"scroll":e+a.attachment,-1<b.inArray("attachment",f)&&(e+="!important"),e+=";");-1===b.inArray("position",c)&&(e=e+"background-position:"+(a.position.horizontal.value+a.position.horizontal.unit+" "),e+=a.position.vertical.value+a.position.vertical.unit,-1<b.inArray("attachment",f)&&(e+="!important"),e+=";");return e};m.generateCssFromProperty.text=function(a,c,f,d,e){d="";var k="text-shadow:",h="",g=s,g=[];-1===b.inArray("fontFamily",c)&&(b.isArray(a.customFontFamilies)&&(g=a.customFontFamilies),
b.isArray(e)&&(g=g.concat(e)),(g=t.style.getImportUrlFromFont(g,a.fontFamily))&&m.addCssImport(g),d='font-family:"'+a.fontFamily+'"',-1<b.inArray("fontFamily",f)&&(d+="!important"),d+=";");-1===b.inArray("color",c)&&(d+="color:"+a.color,-1<b.inArray("color",f)&&(d+="!important"),d+=";");-1===b.inArray("size",c)&&(d+="font-size:"+a.size.value+a.size.unit,-1<b.inArray("size",f)&&(d+="!important"),d+=";");-1===b.inArray("style",c)&&(d+="font-style:"+a.style,-1<b.inArray("style",f)&&(d+="!important"),
d+=";");-1===b.inArray("weight",c)&&(d+="font-weight:"+a.weight,-1<b.inArray("weight",f)&&(d+="!important"),d+=";");-1===b.inArray("lineHeight",c)&&(d+="line-height:"+a.lineHeight.value+a.lineHeight.unit,-1<b.inArray("lineHeight",f)&&(d+="!important"),d+=";");if(-1===b.inArray("transform",c)){d+="text-transform:";switch(a.transform){case "uppercase":d+="uppercase";break;case "lowercase":d+="lowercase";break;case "capitalize":d+="capitalize";break;default:d+="none"}-1<b.inArray("transform",f)&&(d+=
"!important");d+=";"}-1===b.inArray("decorations",c)&&("object"==typeof a.decorations&&(!0===a.decorations.underline&&(h=" underline"),!0===a.decorations.overline&&(h+=" overline"),!0===a.decorations.lineThrough&&(h+=" line-through")),""==h&&(h="none"),d+="text-decoration:"+h,-1<b.inArray("decorations",f)&&(d+="!important"),d+=";");-1===b.inArray("shadows",c)&&("object"==typeof a.shadows&&a.shadows.show&&b.isArray(a.shadows.list)&&0<a.shadows.list.length?(b.each(a.shadows.list,function(b,a){k+=a.x.value+
a.x.unit+" "+a.y.value+a.y.unit+" "+a.radius.value+a.radius.unit+" "+a.color+", "}),k=k.substr(0,k.length-2)):k+="none",d+=k,-1<b.inArray("shadows",f)&&(d+="!important"),d+=";");return d};m.generateCssFromProperty.border=function(a,c,f){var d="",e=-1==b.inArray("topSide",c),k=-1==b.inArray("bottomSide",c),h=-1==b.inArray("leftSide",c),g=-1==b.inArray("rightSide",c),l=-1<b.inArray("width",f),m=-1<b.inArray("style",f),n=-1<b.inArray("color",f),q=function(a,d){var f="";d=d?d+"-":"";-1==b.inArray("width",
c)&&(f+="border-"+d+"width:"+a.width.value+a.width.unit+(l?"!important":"")+";");-1==b.inArray("style",c)&&(f+="border-"+d+"style:"+a.style+(m?"!important":"")+";");-1==b.inArray("color",c)&&(f+="border-"+d+"color:"+a.color+(n?"!important":"")+";");return f};if("object"!=typeof a)return"";if(a.width||a.style||a.color){if(e&&k&&h&&g)return q(a);a={top:a,bottom:a,left:a,right:a}}b.each(a,function(a,f){-1==b.inArray(a+"Side",c)&&(d+=q(f,a))});return d};m.generateCssFromProperty.boxShadow=function(a,
c,f){var d="box-shadow:",e=0;if(-1!=b.inArray("shadows",c)||"object"!=typeof a)return"";if(!1!==a.show&&b.isArray(a.list)&&0!=a.list.length){for(;e<a.list.length;e++)c=a.list[e],d+=(c.inset?"inset ":"")+c.x.value+c.x.unit+" "+c.y.value+c.y.unit+" "+c.blur.value+c.blur.unit+" "+c.spread.value+c.spread.unit+" "+c.color+", ";d=d.substr(0,d.length-2)}else d+="none";-1<b.inArray("shadows",f)&&(d+="!important");return d+";"};m.generatePropertyEditorHtml=function(a,c,f,d,e,k,h,g){c=m.generatePropertyEditorHtml[c];
if(c!=s)return b.isArray(f)||(f=[]),c(a,f,d,e,k,h,g)};m.propertyStateSubsectionDropdown=function(a,c,f,d){c=M[c];var e,k,h,g;c!=s&&0!=c.length&&(g=a.parents(".styleEditor > .editor.standardScrollbar"),e=b('<div class="subsectionsSelectionDropdownWrapper"><div class="trigger"><span></span></div><div class="dropdown"><ol /></div></div>').prependTo(a),k=b("> div.dropdown",e),h=b("> ol",k),k=b("> div.trigger",e),k.on("click",function(){e.toggleClass("expanded");g.tinyscrollbar_update("relative")}),b.each(c,
function(c,e){var k,q,u;-1<b.inArray(e.id,f)||(k=b('<li><span><label><input type="checkbox" />'+t.html.encode(e.name)+"</label></span></li>"),q=b("input",k),u=b(".propertySubsection."+e.id,a),-1===b.inArray(e.id,d.disabled)?(q[0].checked=!0,u.removeClass("hide")):(q[0].checked=!1,u.addClass("hide")),q.on("change",function(){var a=b.inArray(e.id,d.disabled);q[0].checked?(-1!=a&&(d.disabled=t.array.removeItem(e.id,d.disabled)),u.trigger("enabling").removeClass("hide")):(-1===a&&(d.disabled==s&&(d.disabled=
[]),d.disabled.push(e.id)),u.trigger("disabling").addClass("hide"));g.tinyscrollbar_update("relative");m.updateActiveSubjectStyle()}),k.appendTo(h))}))};M.background=[{id:"color",name:"Color"},{id:"image",name:"Image"},{id:"repeat",name:"Repeat"},{id:"attachment",name:"Attachment"},{id:"position",name:"Position"}];m.generatePropertyEditorHtml.background=function(a,c,f,d,e,k){var h=f[d].values,g,l=!1,w=!1,n=B,q=x[n],u=q.styleGroups[q.subjects[C[n]].styleGroup],r=u.imagesMeta[k],v=s,I=a.parents(".styleEditor > .editor.standardScrollbar"),
$,p,W,y,ia,ja,z,Q,E,D,A,K;Q=function(a,c){r[a]!=s&&b.each(r[a],function(d,f){var e=b('<li><div class="image"><img alt="" src="'+r.baseUrl.replace(/_-StyleAssetsClientRoot-_/g,u.styleAssetsClientRoot)+a+"/"+d+'" />'+("uploaded"==a?'<div class="alert" /><div class="loading delete" />':"")+"</div></li>");"object"==typeof h.image&&h.image.type==a&&h.image.file==d&&e.addClass("active");"uploaded"==a&&e.append('<div class="delete" title="Delete this image"><span /></div><div class="deleteConfirm" title="Really delete this image"><span /></div>');
c.css("display","block").append(e.data("file",d))})};-1===b.inArray("color",c)&&(a.append('<div class="propertySubsection color">Color: <input type="text" class="spectrumPicker" /></div>'),b("> .propertySubsection.color",a).on("disabling",function(){$.spectrum("hide")}),$=b("> .propertySubsection.color > input.spectrumPicker",a).spectrum(L(h.color,function(b){f[d].values.color=b;m.updateActiveSubjectStyle()})),G.push($));-1===b.inArray("image",c)&&(n=b('<div class="collapsableOptionsContainer propertySubsection image"><div class="trigger"><label><input type="checkbox" value="1" />Set image</label></div><div class="contentWrapper"><div class="content"><ul class="imageList predefined"></ul><ul class="imageList uploaded"></ul><div class="uploadWrapper"><div class="uploader"></div><ol></ol><div class="actions"><div class="action fileSelection"><span>Upload</span><input type="file" value="" multiple="multiple" /></div></div></div></div></div></div>').appendTo(a),
W=b("> .trigger input",n),p=b("> .contentWrapper",n),W.on("change",function(){W[0].checked?f[d].values.image=v!=s&&r[v.type]&&r[v.type][v.file]?v:s:(v=f[d].values.image,f[d].values.image=s);m.updateActiveSubjectStyle()}),"object"==typeof h.image&&"string"==typeof h.image.completeUrl&&""!=h.image.completeUrl&&(n.addClass("expanded"),p.css("display","block"),W[0].checked=!0),r&&(Q("predefined",b(".imageList.predefined",p)),Q("uploaded",b(".imageList.uploaded",p))),p.on("click",".imageList > li > div.image",
function(){var a=b(this).parent(),c=a.parent().hasClass("predefined")?"predefined":"uploaded",e=a.data("file");a.hasClass("active")||a.hasClass("deleting")||(f[d].values.image={completeUrl:r.baseUrl+c+"/"+e,file:e,type:c},m.updateActiveSubjectStyle(),b(".imageList > li",p).removeClass("active"),a.addClass("active"))}).on("click",".imageList > li > div.delete",function(){var a=b(this),c=a.parent();c.hasClass("confirmDelete")?(c.removeClass("confirmDelete"),a.parents(1).removeClass("transparentItems"),
a.attr("title","Delete this image")):(c.addClass("confirmDelete"),a.parents(1).addClass("transparentItems"),a.attr("title","Don't delete the image"))}).on("mouseleave",".imageList > li",function(){var a=b(this);a.parent().removeClass("transparentItems");a.removeClass("confirmDelete").find("> .delete").attr("title","Delete this image")}).on("click",".imageList > li > div.deleteConfirm",function(){var a=b(this).parent(),c=a.parent(),d=b(".imageList.uploaded",c.parents(".propertyStatesWrapper > div").siblings()),
f=a.data("file"),e,g=s,h=function(){a.removeClass("showLoading deleting");b("> .image > .alert",a).css("display","block").attr("title","There has been a problem while trying to delete this image. Please try again.")},l=function(a,c){var d=m.getStyleProperty(a.values,k.split("_"));b.each(d,function(b,a){var d=a.values.image;"object"==typeof d&&d.type==c&&d.file==f&&(a.values.image=s)})},v=function(){a.addClass("showLoading deleting");b.ajax({data:{collection:q.type,action:"deleteBackgroundImage",themeName:u.themeName,
collectionPortalId:u.portalId,universalPropertyId:k,file:f},dataType:"json",success:function(g){g.success!=s&&g.success?(y&&(b.each(e.custom,function(b,a){l(a,"uploaded")}),b.each(e.predefined,function(b,a){l(a,"predefined")})),delete r.uploaded[f],b.isEmptyObject(r.uploaded)?(a.fadeOut(200,function(){a.remove();0==b(">",c).length&&c.css("display","none")}),d.empty().css("display","none")):(b("> li",d).each(function(a,c){var d=b(c);d.data("file")==f&&d.remove()}),a.fadeOut(200,function(){a.remove()})),
I.tinyscrollbar_update("relative"),m.updateActiveSubjectStyle()):h()},error:function(){h()},timeout:15E3,url:F.backend})},y="";collectionIndex=B;subjectIndex=C[collectionIndex];q=x[collectionIndex];subject=q.subjects[subjectIndex];e=m.listStylesThatUseBackgroundImage(f,"uploaded",k);b.isEmptyObject(e.custom)||b.each(e.custom,function(b,a){var c=t.style.getNameAndColors(a,subject.templateGroup);y+="<li>"+c.name+"</li>"});b.isEmptyObject(e.predefined)||b.each(e.predefined,function(b,a){var c=t.style.getNameAndColors(a,
subject.templateGroup);y+="<li>"+c.name+"</li>"});y?(b("body").append('<div id="EasyDNNstyleWizardModalWrapper" class="imageDeleteConfirmation"><div><div class="content"><p>The image you are deleting is used in the following styles. Do you want to procede?</p><ul>'+y+'</ul></div><div class="actions"><span class="delete">Delete the image</span><span class="cancel">Cancel deletion</span></div></div></div>'),g=b("#EasyDNNstyleWizardModalWrapper").on("click",".actions > span",function(){b(this).hasClass("delete")&&
v();g.fadeOut(100,function(){g.remove()})})):v()}),K=b(".uploadWrapper > ol",p),A=b(".uploadWrapper > .uploader",p).fineUploader({uploaderType:"basic",autoUpload:!0,maxConnections:1,request:{endpoint:F.backend,inputName:"file",uuidName:"uuid",totalFileSizeName:"filesize",params:{collection:q.type,action:"uploadBackgroundImage",themeName:u.themeName,collectionPortalId:u.portalId,universalPropertyId:k}},validation:{allowedExtensions:["jpg","jpeg","gif","png","bmp"],stopOnFirstInvalidFile:!1}}).on("submit",
function(a,c,d){a=A.fineUploader("getFile",c);var f=b('<li class="file'+c+'"><div class="main"><p class="file">'+t.html.encode(a.name)+'</p><p class="uploadInfo">Queued ('+t.files.readableFileSize(a.size)+')</p><div class="progress"><div></div></div><div class="actions"><span class="retry" style="display: none;">Retry</span><span class="cancel">Cancel</span></div></div><div class="thumbnail"></div></li>').appendTo(K);d=new FileReader;var e=f.parent();b(".imageList.uploaded",e.parents(".propertyStatesWrapper > div").siblings());
d.onload=function(a){b("> .thumbnail",f).prepend('<img src="'+a.target.result+'" alt="" />')};f.data("imageReader",d).data("fileId",c);d.readAsDataURL(a);I.tinyscrollbar_update("relative")}).on("upload",function(a,c,d){a=b("> li.file"+c,K);a=b("> .main",a);b("> .progress",a).css("display","block")}).on("progress",function(a,c,d,f,e){a=b("> li.file"+c+" > .main",K);c=f/e*100;b("> .uploadInfo",a).text(Math.round(c)+"% ("+t.files.readableFileSize(f)+" of "+t.files.readableFileSize(e)+")");b("> .progress > div",
a).css("width",c+"%")}).on("complete",function(a,c,d,f){var e=b("> li.file"+c,K);c=b("> .main",e);a=e.data("imageReader");f.success==s||!0!==f.success?(e.addClass("failed"),b("> .uploadInfo",c).text("Upload failed"),b("> .progress",c).css("display","none"),b("> .progress > div",c).css("width",""),b("> .actions > .retry",c).css("display","")):(r.uploaded==s&&(r.uploaded={}),r.uploaded[f.filename]={width:f.width,height:f.height},c=b("ul.imageList.uploaded",e.parents(".propertyStatesWrapper").eq(0)).css("display",
"block"),b('<li><div class="image"><img alt="" src="'+r.baseUrl.replace(/_-StyleAssetsClientRoot-_/g,u.styleAssetsClientRoot)+"uploaded/"+f.filename+'" /><div class="alert" /><div class="loading delete" /></div><div class="delete" title="Delete this image"><span /></div><div class="deleteConfirm" title="Really delete this image"><span /></div></li>').data("file",f.filename).appendTo(c),a.readyState===FileReader.LOADING&&a.abort(),e.slideUp(200,function(){e.remove();I.tinyscrollbar_update("relative")}))}),
b(".uploadWrapper .fileSelection > input",p).on("change",function(){A.fineUploader("addFiles",this.files)}),K.on("click","> li > .main > .actions > .retry",function(){var a=b(this),c=a.parents().eq(2),d=c.data("fileId"),f=A.fineUploader("getFile",d);c.is(":last-child")||(c=c.detach().appendTo(K));c.removeClass("failed");b("> .main > .uploadInfo",c).text("Queued ("+t.files.readableFileSize(f.size)+")");a.css("display","none");A.fineUploader("retry",d)}).on("click","> li > .main > .actions > .cancel",
function(){var a=b(this).parents().eq(2);A.fineUploader("cancel",a.data("fileId"));a.remove()}));-1===b.inArray("position",c)&&(a.append('<div class="propertySubsection position"><div class="positionSelection horizontal">Horizontal position: <label><input type="radio" value="1" class="leftBgPosition" name="'+e+'_horizontalImagePositionRadios" />Left</label> <label><input type="radio" value="1" class="center" name="'+e+'_horizontalImagePositionRadios" />Center</label> <label><input type="radio" value="1" class="rightBgPosition" name="'+
e+'_horizontalImagePositionRadios" />Right</label> <label><input type="radio" value="1" class="custom" name="'+e+'_horizontalImagePositionRadios" />Custom</label><div>Custom: <input type="text" class="position numeric" value="" /> <select class="positionUnit numericUnit"><option value="px">px</option><option value="%">%</option><option value="em">em</option></select> </div></div><div class="positionSelection vertical">Vertical position: <label><input type="radio" value="1" class="top" name="'+e+'_verticalImagePositionRadios" />Top</label> <label><input type="radio" value="1" class="center" name="'+
e+'_verticalImagePositionRadios" />Center</label> <label><input type="radio" value="1" class="bottom" name="'+e+'_verticalImagePositionRadios" />Bottom</label> <label><input type="radio" value="1" class="custom" name="'+e+'_verticalImagePositionRadios" />Custom</label><div>Custom: <input type="text" class="position numeric" value="" /> <select class="positionUnit numericUnit"><option value="px">px</option><option value="%">%</option><option value="em">em</option></select> </div></div></div>'),y=b("> .propertySubsection.position > .positionSelection.vertical",
a),ia=b("input.position",y),ja=b("select.positionUnit",y),z=b("> div",y),n=b("> .propertySubsection.position > .positionSelection.horizontal",a),Q=b("input.position",n),E=b("select.positionUnit",n),D=b("> div",n),g=h.position.vertical,ia.val(g.value),ja.val(g.unit),0==g.value&&(l=!0,b("input.top",y)[0].checked=!0),l||"%"!=g.unit||(50==g.value?(l=!0,b("input.center",y)[0].checked=!0):100==g.value&&(l=!0,b("input.bottom",y)[0].checked=!0)),l||(z.css("display","block"),b("input.custom",y)[0].checked=
!0),l=h.position.horizontal,Q.val(l.value),E.val(l.unit),0==l.value&&(w=!0,b("input.leftBgPosition",n)[0].checked=!0),w||"%"!=l.unit||(50==l.value?(w=!0,b("input.center",n)[0].checked=!0):100==l.value&&(w=!0,b("input.rightBgPosition",n)[0].checked=!0)),w||(D.css("display","block"),b("input.custom",n)[0].checked=!0),b('> .propertySubsection.position > .positionSelection > label > input[type="radio"]',a).on("change",function(){var a=b(this),c=a.parents().eq(1),e=b("> div",c),c=c.hasClass("horizontal")?
"horizontal":"vertical";a.hasClass("custom")?e.css("display","block"):(e.css("display","none"),a=a.hasClass("center")?50:a.hasClass("leftBgPosition")||a.hasClass("top")?0:100,f[d].values.position[c].value=a,f[d].values.position[c].unit="%",b("input.position",e).val(a),b("select.positionUnit",e).val("%"),m.updateActiveSubjectStyle());I.tinyscrollbar_update("relative")}),b("> .propertySubsection.position > .positionSelection",a).on("keydown","input.numeric",function(a){var c=b(this),e=c.val(),g=c.parents().eq(1).hasClass("horizontal")?
"horizontal":"vertical",g=f[d].values.position[g];if(38==a.which||40==a.which){e=""==e?0:"px"==g.unit?parseInt(e,10):parseFloat(e,10);switch(a.which){case 38:e+=1;break;case 40:e-=1}c.val(e).data("stepChange",!0);g.value=e;m.updateActiveSubjectStyle()}}).on("keyup change","input.numeric",function(a){var c=b(this),e=c.val(),g=!1,k="",h;h=c.parents().eq(1).hasClass("horizontal")?"horizontal":"vertical";var l=f[d].values.position[h];"px"==l.unit?h=parseInt(e,10):(g="."==e[e.length-1],h=parseFloat(e,
10));if(isNaN(h)||"number"!=typeof h)h=0;if(!0==c.data("stepChange")||"0"==e||"keyup"!=a.type||0!=h)c.data("stepChange",!1),k=h+(g?".":"");c.val(k);l.value=h;m.updateActiveSubjectStyle()}).on("keydown keyup change","select.numericUnit",function(){var a=b(this),c=a.parents().eq(1).hasClass("horizontal")?"horizontal":"vertical";f[d].values.position[c].unit=a.val();m.updateActiveSubjectStyle()}));-1===b.inArray("repeat",c)&&(w=b('<div class="propertySubsection repeat">Repeat: <label><input type="radio" value="repeat" class="repeat" name="'+
e+'_imageRepeat" />Both</label> <label><input type="radio" value="repeat-x" class="repeat-x" name="'+e+'_imageRepeat" />Horizontal</label> <label><input type="radio" value="repeat-y" class="repeat-y" name="'+e+'_imageRepeat" />Vertical</label> <label><input type="radio" value="no-repeat" class="no-repeat" name="'+e+'_imageRepeat" />No</label></div>').appendTo(a),b("input",w).on("change",function(){f[d].values.repeat=b(this).val();m.updateActiveSubjectStyle()}).filter("."+(h.repeat?h.repeat:"repeat"))[0].checked=
!0);-1===b.inArray("attachment",c)&&(a=b('<div class="propertySubsection attachment">Attachment: <label><input type="radio" value="scroll" class="scroll" name="'+e+'_imageAttachment" />Scroll</label> <label><input type="radio" value="fixed" class="fixed" name="'+e+'_imageAttachment" />Fixed</label></div>').appendTo(a),b("input",a).on("change",function(){f[d].values.attachment=b(this).val();m.updateActiveSubjectStyle()}).filter("."+(h.attachment?h.attachment:"scroll"))[0].checked=!0)};M.border=[{id:"width",
name:"Width"},{id:"style",name:"Style"},{id:"color",name:"Color"},{id:"topSide",name:"Top"},{id:"bottomSide",name:"Bottom"},{id:"leftSide",name:"Left"},{id:"rightSide",name:"Right"}];m.generatePropertyEditorHtml.border=function(a,c,f,d,e){e=b("<ul><li><span>Uniform border</span></li><li><span>Specify each side</span></li></ul>");var k,h,g=a.parents(".styleEditor > .editor.standardScrollbar"),l=f[d].values,w,n=!(l.color!=s||l.width!=s||l.style!=s),q=-1==b.inArray("width",c),u=-1==b.inArray("style",
c),r=-1==b.inArray("color",c),v="top",I=0,p=function(b){var a="";q&&(a='<div class="propertySubsection width"><input type="text" class="width numeric" value="'+b.width.value+'" /> <select class="widthUnit numericUnit"><option value="px"'+("px"==b.width.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==b.width.unit?' selected="selected"':"")+">em</option></select> </div>");u&&(a+='<div class="propertySubsection style"><select class="style"><option value="solid"'+("solid"==b.style?
' selected="selected"':"")+'>solid</option><option value="dotted"'+("dotted"==b.style?' selected="selected"':"")+'>dotted</option><option value="dashed"'+("dashed"==b.style?' selected="selected"':"")+'>dashed</option><option value="double"'+("double"==b.style?' selected="selected"':"")+'>double</option><option value="groove"'+("groove"==b.style?' selected="selected"':"")+'>groove</option><option value="ridge"'+("ridge"==b.style?' selected="selected"':"")+'>ridge</option><option value="inset"'+("inset"==
b.style?' selected="selected"':"")+'>inset</option><option value="outset"'+("outset"==b.style?' selected="selected"':"")+">outset</option></select> </div>");r&&(a+='<div class="propertySubsection color"><input type="text" class="spectrumPicker" /></div>');return a},t=function(b){return function(a){n?f[d].values[b].color=a:f[d].values.color=a;m.updateActiveSubjectStyle()}},x=function(){["top","right","bottom","left"].map(function(a){-1==b.inArray(a+"Side",c)&&-1==b.inArray(a+"Side",f[d].disabled)&&
"object"==typeof f[d].values[a]&&(v=a)})};a.append(e,'<div class="borderEditor"><div class="oneForAll"></div><div class="eachSide"></div></div>');k=b("> div > .oneForAll",a);h=b("> div > .eachSide",a);x();n?(b("> li",e).eq(1).addClass("active"),w=l[v]):(b("> li",e).eq(0).addClass("active"),w=l);["top","right","bottom","left"].map(function(a){var d;-1!=b.inArray(a+"Side",c)?I+=1:(d=b("<div />").addClass("propertySubsection "+a+"Side").html(a[0].toUpperCase()+a.substr(1)+": "+p(n?l[a]:l)).data("borderSide",
a).appendTo(h),r&&G.push(b("input.spectrumPicker",d).spectrum(L(n?l[a].color:l.color,t(a)))))});3<=I?e.css("display","none"):k.append(p(w));r&&(G.push(b("input.spectrumPicker",k).spectrum(L(n?l[v].color:l.color,t(v)))),b(".propertySubsection.color",a).on("disabling",function(){b("input.spectrumPicker",a).spectrum("hide")}));n||3<=I?k.css("display","none"):h.css("display","none");q&&(b("input.width",a).on("keydown",function(a){var c=b(this),e=c.val(),g;if(38==a.which||40==a.which){g=n?f[d].values[c.parents().eq(1).data("borderSide")].width.unit:
f[d].values.width.unit;e=""==e?0:"px"==g?parseInt(e,10):parseFloat(e,10);switch(a.which){case 38:e+=1;break;case 40:e-=1,0>e&&(e=0)}c.val(e).data("stepChange",!0);n?f[d].values[c.parents().eq(1).data("borderSide")].width.value=e:f[d].values.width.value=e;m.updateActiveSubjectStyle()}}).on("keyup change",function(a){var c=b(this),e=c.val(),g=!1,h,k="";"px"==(n?f[d].values[c.parents().eq(1).data("borderSide")].width.unit:f[d].values.width.unit)?h=parseInt(e,10):(g="."==e[e.length-1],h=parseFloat(e,
10));if(isNaN(h)||"number"!=typeof h||0>h)h=0;if(!0==c.data("stepChange")||"0"==e||"keyup"!=a.type||0!=h)c.data("stepChange",!1),k=h+(g?".":"");c.val(k);n?f[d].values[c.parents().eq(1).data("borderSide")].width.value=h:f[d].values.width.value=h;m.updateActiveSubjectStyle()}),b("select.widthUnit",a).on("keydown keyup change",function(){var a=b(this),c=a.val();n?f[d].values[a.parents().eq(1).data("borderSide")].width.unit=c:f[d].values.width.unit=c;m.updateActiveSubjectStyle()}));if(u)b("select.style",
a).on("keydown keyup change",function(){var a=b(this),c=a.val();n?f[d].values[a.parents().eq(1).data("borderSide")].style=c:f[d].values.style=c;m.updateActiveSubjectStyle()});e.on("click","> li",function(){var a=b(this),c;a.hasClass("active")||(a.addClass("active").siblings().removeClass("active"),c=b.extend(!0,{},f[d].values),(n=1==a.index())?(f[d].values={top:b.extend(!0,{},c),right:b.extend(!0,{},c),bottom:b.extend(!0,{},c),left:b.extend(!0,{},c)},r&&(b("input.spectrumPicker",k).spectrum("hide"),
b("input.spectrumPicker",h).spectrum("set",c.color)),q&&(b("input.width",h).val(c.width.value),b('select.widthUnit option[value="'+c.width.unit+'"]',h).prop("selected",!0)),u&&b('select.style option[value="'+c.style+'"]',h).prop("selected",!0),k.css("display","none"),h.css("display","")):(x(),a=c[v],f[d].values=a,r&&(b("input.spectrumPicker",h).spectrum("hide"),b("input.spectrumPicker",k).spectrum("set",a.color)),q&&(b("input.width",k).val(a.width.value),b('select.widthUnit option[value="'+a.width.unit+
'"]',k)[0].selected=!0),u&&(b('select.style option[value="'+a.style+'"]',k)[0].selected=!0),k.css("display",""),h.css("display","none"),m.updateActiveSubjectStyle()),g.tinyscrollbar_update("relative"))})};M.boxShadow=[{id:"shadows",name:"Shadows"}];m.generatePropertyEditorHtml.boxShadow=function(a,c,f,d,e){e=f[d].values;var k=function(a){return function(c){b.contains(ba.documentElement,a[0])&&(f[d].values.list[a.index()].color=c,m.updateActiveSubjectStyle())}},h=function(a){var c=b('<div><div><span class="remove">Remove</span></div><div>Horizontal: <input type="text" class="x numeric" value="'+
a.x.value+'" /> <select class="xUnit numericUnit"><option value="px"'+("px"==a.x.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.x.unit?' selected="selected"':"")+'>em</option></select> Vertical: <input type="text" class="y numeric" value="'+a.y.value+'" /> <select class="yUnit numericUnit"><option value="px"'+("px"==a.y.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.y.unit?' selected="selected"':"")+'>em</option></select> </div><div>Blur: <input type="text" class="blur numeric" value="'+
a.blur.value+'" /> <select class="blurUnit numericUnit"><option value="px"'+("px"==a.blur.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.blur.unit?' selected="selected"':"")+'>em</option></select> Spread: <input type="text" class="spread numeric" value="'+a.spread.value+'" /> <select class="spreadUnit numericUnit"><option value="px"'+("px"==a.spread.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.spread.unit?' selected="selected"':"")+'>em</option></select> <input type="text" class="spectrumPicker" /></div><div><label><input type="checkbox" class="inset"'+
(a.inset?' checked="checked"':"")+" />Inset</label></div></div>").appendTo(u);G.push(b("> div > input.spectrumPicker",c).spectrum(L(a.color,k(c))))},g=a.parents(".styleEditor > .editor.standardScrollbar"),l,w,n,q,u,r;-1==b.inArray("shadows",c)&&(a.append('<div class="collapsableOptionsContainer propertySubsection shadows"><div class="trigger"><label><input type="checkbox" value="1" />Shadows</label></div><div class="contentWrapper"><div class="content"><span>Add shadow</span><p>No shadows set</p><div class="shadowsList"></div></div></div></div>'),
c=b("> .collapsableOptionsContainer.shadows",a),r=b("> .trigger input",c),l=b("> .contentWrapper",c),w=b("> .content",l),q=b("> span",w),n=b("> p",w),u=b("> .shadowsList",w),r.on("change",function(){f[d].values.show=this.checked;f[d].values.list&&0<f[d].values.list.length?(n.css("display","none"),u.css("display","block")):(n.css("display","block"),u.css("display","none"));m.updateActiveSubjectStyle()}),n.css("display","block"),u.css("display","none"),r[0].checked=!1,"object"==typeof e&&(e.show&&0<
e.list.length&&(c.addClass("expanded"),r[0].checked=!0,l.css("display","block"),n.css("display","none"),u.css("display","block")),0<e.list.length&&b.each(e.list,function(a,b){h(b)})),u.on("click","> div > div > span.remove",function(){var a=b(this).parents().eq(1);b("> div > input.spectrumPicker",a).spectrum("destroy");f[d].values.list.splice(a.index(),1);a.remove();0==f[d].values.list.length&&(n.css("display","block"),u.css("display","none"));m.updateActiveSubjectStyle();g.tinyscrollbar_update("relative")}).on("change",
"> div input.inset",function(){f[d].values.list[b(this).parents().eq(2).index()].inset=this.checked;m.updateActiveSubjectStyle()}).on("keydown","input.numeric",function(a){var c=b(this),e=c.val(),h=c.hasClass("blur")?"blur":c.hasClass("spread")?"spread":c.hasClass("x")?"x":"y",g=f[d].values.list[c.parents().eq(1).index()][h];if(38==a.which||40==a.which){e=""==e?0:"px"==g.unit?parseInt(e,10):parseFloat(e,10);switch(a.which){case 38:e+=1;break;case 40:e-=1,"blur"==h&&0>e&&(e=0)}c.val(e).data("stepChange",
!0);g.value=e;m.updateActiveSubjectStyle()}}).on("keyup change","input.numeric",function(a){var c=b(this),e=c.val(),h=!1,g="",k,l=c.hasClass("blur")?"blur":c.hasClass("spread")?"spread":c.hasClass("x")?"x":"y",n=f[d].values.list[c.parents().eq(1).index()][l];"px"==n.unit?k=parseInt(e,10):(h="."==e[e.length-1],k=parseFloat(e,10));if(isNaN(k)||"number"!=typeof k||"blur"==l&&0>k)k=0;if(!0==c.data("stepChange")||"0"==e||"keyup"!=a.type||0!=k)c.data("stepChange",!1),g=k+(h?".":"");c.val(g);n.value=k;m.updateActiveSubjectStyle()}).on("keydown keyup change",
"select.numericUnit",function(){var a=b(this),c=a.hasClass("blur")?"blur":a.hasClass("spread")?"spread":a.hasClass("x")?"x":"y";f[d].values.list[a.parents().eq(1).index()][c].unit=a.val();m.updateActiveSubjectStyle()}),q.on("click",function(){var a={inset:!1,x:{value:1,unit:"px"},y:{value:1,unit:"px"},blur:{value:3,unit:"px"},spread:{value:0,unit:"px"},color:"#000000"};0==f[d].values.list.length&&(n.css("display","none"),u.css("display","block"));f[d].values.list.push(a);h(a);m.updateActiveSubjectStyle();
g.tinyscrollbar_update("relative")}),b("> .propertySubsection.shadows",a).on("disabling",function(){b("input.spectrumPicker",u).spectrum("hide")}))};M.text=[{id:"fontFamily",name:"Font family"},{id:"color",name:"Color"},{id:"size",name:"Size"},{id:"style",name:"Style"},{id:"weight",name:"Weight"},{id:"lineHeight",name:"Line height"},{id:"transform",name:"Transform"},{id:"decorations",name:"Decorations"},{id:"shadows",name:"Shadows"}];m.generatePropertyEditorHtml.text=function(a,c,f,d,e,k,h){var g=
f[d].values,l=[],w=function(a){return function(c){b.contains(ba.documentElement,a[0])&&(f[d].values.shadows.list[a.index()].color=c,m.updateActiveSubjectStyle())}},n=function(a){var c=b('<div><div><span class="remove">Remove</span></div><div>Horizontal: <input type="text" class="x numeric" value="'+a.x.value+'" /> <select class="xUnit numericUnit"><option value="px"'+("px"==a.x.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.x.unit?' selected="selected"':"")+'>em</option></select> Vertical: <input type="text" class="y numeric" value="'+
a.y.value+'" /> <select class="yUnit numericUnit"><option value="px"'+("px"==a.y.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.y.unit?' selected="selected"':"")+'>em</option></select> </div><div>Radius: <input type="text" class="radius numeric" value="'+a.radius.value+'" /> <select class="radiusUnit numericUnit"><option value="px"'+("px"==a.radius.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==a.radius.unit?' selected="selected"':"")+'>em</option></select> <input type="text" class="spectrumPicker" /></div></div>').appendTo(t);
a=b("> div > input.spectrumPicker",c).spectrum(L(a.color,w(c)));G.push(a)},q=a.parents(".styleEditor > .editor.standardScrollbar"),u,r,v,p,t,x,z,y,A,B,C;r=-1==b.inArray("fontFamily",c);p=-1==b.inArray("color",c);x=-1==b.inArray("size",c);var E=-1==b.inArray("lineHeight",c),D=-1==b.inArray("style",c),H=-1==b.inArray("weight",c),J=-1==b.inArray("shadows",c);k=-1==b.inArray("decorations",c);c=-1==b.inArray("transform",c);if(r||p)a.append("<div>"+(r?'<select class="propertySubsection fontFamily"></select> ':
"")+(p?'<span class="propertySubsection color"><input type="text" class="spectrumPicker" /></span>':"")+"</div>"),r&&(b.isArray(g.customFontFamilies)&&(l=g.customFontFamilies),b.isArray(h.customFonts)&&(l=l.concat(h.customFonts)),b.isArray(F.defaultFonts)&&(l=l.concat(F.defaultFonts)),u=b("> div > select.fontFamily",a).on("keydown keyup change",function(){f[d].values.fontFamily=b(this).val();m.updateActiveSubjectStyle()}),b.each(l,function(a,b){u.append('<option value="'+b.name+'"'+(g.fontFamily==
b.name?' selected="selected"':"")+">"+b.name+"</option>")})),p&&(C=b("> div > .propertySubsection.color > .spectrumPicker",a).spectrum(L(g.color,function(a){f[d].values.color=a;m.updateActiveSubjectStyle()})),G.push(C),b("> div > .propertySubsection.color",a).on("disabling",function(){C.spectrum("hide")}));if(x||E)x&&a.append('<div class="propertySubsection size">Size: <input type="text" class="size numeric" value="'+g.size.value+'" /> <select class="sizeUnit numericUnit"><option value="px"'+("px"==
g.size.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==g.size.unit?' selected="selected"':"")+'>em</option><option value="%"'+("%"==g.size.unit?' selected="selected"':"")+">%</option></select> </div>"),E&&a.append('<div class="propertySubsection lineHeight">Line height: <input type="text" class="lineHeight numeric" value="'+g.lineHeight.value+'" /> <select class="lineHeightUnit numericUnit"><option value=""'+(""==g.lineHeight.unit?' selected="selected"':"")+'><em>font size ratio</em></option><option value="px"'+
("px"==g.lineHeight.unit?' selected="selected"':"")+'>px</option><option value="em"'+("em"==g.lineHeight.unit?' selected="selected"':"")+'>em</option><option value="%"'+("%"==g.lineHeight.unit?' selected="selected"':"")+">%</option></select> </div>"),b("> div > input.size, > div > input.lineHeight",a).on("keydown",function(a){var c=b(this),e=c.val(),h,g=c.hasClass("size")?"size":"lineHeight";if(38==a.which||40==a.which){h=f[d].values[g].unit;e=""==e?0:"px"==h?parseInt(e,10):parseFloat(e,10);switch(a.which){case 38:e+=
1;break;case 40:e-=1,0>e&&(e=0)}c.val(e).data("stepChange",!0);f[d].values[g].value=e;m.updateActiveSubjectStyle()}}).on("keyup change",function(a){var c=b(this),e=c.val(),h=!1,g,k="",l=c.hasClass("size")?"size":"lineHeight";"px"==f[d].values[l].unit?g=parseInt(e,10):(h="."==e[e.length-1],g=parseFloat(e,10));if(isNaN(g)||"number"!=typeof g||0>g)g=0;if(!0==c.data("stepChange")||"0"==e||"keyup"!=a.type||0!=g)c.data("stepChange",!1),k=g+(h?".":"");c.val(k);f[d].values[l].value=g;m.updateActiveSubjectStyle()}),
b("> div > select.sizeUnit, > div > select.lineHeightUnit",a).on("keydown keyup change",function(){var a=b(this),c=a.hasClass("sizeUnit")?"size":"lineHeight";f[d].values[c].unit=a.val();m.updateActiveSubjectStyle()});if(D||H)a.append("<div>"+(D?'<label class="propertySubsection style"><input type="checkbox" class="style" value="1" />Italic</label>':"")+(H?'<label class="propertySubsection weight"><input type="checkbox" class="weight" value="1" />Bold</label>':"")+"</div>"),b("> div input.style, > div input.weight",
a).on("change",function(){var a=b(this).hasClass("style")?"style":"weight";f[d].values[a]=this.checked?"style"==a?"italic":"bold":"normal";m.updateActiveSubjectStyle()}),D&&b("> div input.style",a).prop("checked","italic"==g.style),H&&b("> div input.weight",a).prop("checked","bold"==g.weight);J&&(a.append('<div class="collapsableOptionsContainer propertySubsection shadows"><div class="trigger"><label><input type="checkbox" value="1" />Shadows</label></div><div class="contentWrapper"><div class="content"><span>Add shadow</span><p>No shadows set</p><div class="shadowsList"></div></div></div></div>'),
h=b("> .collapsableOptionsContainer.shadows",a),x=b("> .trigger input",h),l=b("> .contentWrapper",h),r=b("> .content",l),p=b("> span",r),v=b("> p",r),t=b("> .shadowsList",r),x.on("change",function(){f[d].values.shadows.show=this.checked;m.updateActiveSubjectStyle()}),"object"==typeof g.shadows&&g.shadows.show&&0<g.shadows.list.length?(h.addClass("expanded"),x[0].checked=!0,l.css("display","block"),v.css("display","none"),b.each(g.shadows.list,function(a,b){n(b)})):(v.css("display","block"),t.css("display",
"none"),x[0].checked=!1),t.on("click","> div > div > span.remove",function(){var a=b(this).parents().eq(1);b("> div > input.spectrumPicker",a).spectrum("destroy");f[d].values.shadows.list.splice(a.index(),1);a.remove();0==f[d].values.shadows.list.length&&(v.css("display","block"),t.css("display","none"));m.updateActiveSubjectStyle();q.tinyscrollbar_update("relative")}).on("keydown","input.numeric",function(a){var c=b(this),e=c.val(),g=c.hasClass("radius")?"radius":c.hasClass("x")?"x":"y",h=f[d].values.shadows.list[c.parents().eq(1).index()][g];
if(38==a.which||40==a.which){e=""==e?0:"px"==h.unit?parseInt(e,10):parseFloat(e,10);switch(a.which){case 38:e+=1;break;case 40:e-=1,"radius"==g&&0>e&&(e=0)}c.val(e).data("stepChange",!0);h.value=e;m.updateActiveSubjectStyle()}}).on("keyup change","input.numeric",function(a){var c=b(this),e=c.val(),g=!1,h="",k,l=c.hasClass("radius")?"radius":c.hasClass("x")?"x":"y",n=f[d].values.shadows.list[c.parents().eq(1).index()][l];"px"==n.unit?k=parseInt(e,10):(g="."==e[e.length-1],k=parseFloat(e,10));if(isNaN(k)||
"number"!=typeof k||"radius"==l&&0>k)k=0;if(!0==c.data("stepChange")||"0"==e||"keyup"!=a.type||0!=k)c.data("stepChange",!1),h=k+(g?".":"");c.val(h);n.value=k;m.updateActiveSubjectStyle()}).on("keydown keyup change","select.numericUnit",function(){var a=b(this),c=a.hasClass("radiusUnit")?"radius":a.hasClass("xUnit")?"x":"y";f[d].values.shadows.list[a.parents().eq(1).index()][c].unit=a.val();m.updateActiveSubjectStyle()}),p.on("click",function(){var a={x:{value:1,unit:"px"},y:{value:1,unit:"px"},radius:{value:2,
unit:"px"},color:"#000000"};0==f[d].values.shadows.list.length&&(v.css("display","none"),t.css("display","block"));f[d].values.shadows.list.push(a);n(a);m.updateActiveSubjectStyle();q.tinyscrollbar_update("relative")}),b("> .propertySubsection.shadows",a).on("disabling",function(){b("input.spectrumPicker",t).spectrum("hide")}));if(k){a.append('<div class="collapsableOptionsContainer propertySubsection decorations"><div class="trigger"><label><input type="checkbox" value="1" />Decoration</label></div><div class="contentWrapper"><div class="content"><label><input type="checkbox" value="1" class="underline" />Underline</label> <label><input type="checkbox" value="1" class="overline" />Overline</label> <label><input type="checkbox" value="1" class="lineThrough" />Line through</label> </div></div></div>');
k=b("> .collapsableOptionsContainer.decorations",a);h=b("> .trigger input",k);z=b("input.underline",k);y=b("input.overline",k);A=b("input.lineThrough",k);z.on("change",function(){f[d].values.decorations.underline=this.checked;m.updateActiveSubjectStyle()})[0].checked=!0===g.decorations.underline;y.on("change",function(){f[d].values.decorations.overline=this.checked;m.updateActiveSubjectStyle()})[0].checked=!0===g.decorations.overline;A.on("change",function(){f[d].values.decorations.lineThrough=this.checked;
m.updateActiveSubjectStyle()})[0].checked=!0===g.decorations.lineThrough;if(!0===g.decorations.underline||!0===g.decorations.overline||!0===g.decorations.lineThrough)h[0].checked=!0,k.addClass("expanded"),b("> .contentWrapper",k).css("display","block");h.on("change",function(){f[d].values.decorations.underline=!1;f[d].values.decorations.overline=!1;f[d].values.decorations.lineThrough=!1;z[0].checked=!1;y[0].checked=!1;A[0].checked=!1;m.updateActiveSubjectStyle()})}if(c){a.append('<div class="collapsableOptionsContainer propertySubsection transform"><div class="trigger"><label><input type="checkbox" value="1" />Transform</label></div><div class="contentWrapper"><div class="content"><label><input type="radio" value="1" class="none" name="'+
e+'_transformRadios" />None</label> <label><input type="radio" value="1" class="uppercase" name="'+e+'_transformRadios" />Uppercase</label> <label><input type="radio" value="1" class="lowercase" name="'+e+'_transformRadios" />Lowercase</label> <label><input type="radio" value="1" class="capitalize" name="'+e+'_transformRadios" />Capitalize</label> </div></div></div>');a=b("> .collapsableOptionsContainer.transform",a);e=b("> .trigger input",a);c=b("> .contentWrapper",a);B=b("input.none",c);k=b("input.uppercase",
c);h=b("input.lowercase",c);l=b("input.capitalize",c);if(g.transform==s||""==g.transform||"none"==g.transform)B[0].checked=!0;else switch(e[0].checked=!0,a.addClass("expanded"),c.css("display","block"),g.transform){case "uppercase":k[0].checked=!0;break;case "lowercase":h[0].checked=!0;break;case "capitalize":l[0].checked=!0}b("input",c).on("change",function(){var a=b(this),c="";a.hasClass("uppercase")?c="uppercase":a.hasClass("lowercase")?c="lowercase":a.hasClass("capitalize")&&(c="capitalize");
f[d].values.transform=c;m.updateActiveSubjectStyle()});e.on("change",function(){this.checked||(B[0].checked=!0,f[d].values.transform="",m.updateActiveSubjectStyle())})}};t.html={encode:function(a){return b("<p />").text(a).html()},decode:function(a){return b("<p />").html(a).text()}};t.css={removeClassContaining:function(a,c){a.each(function(){var a=b(this),d=b.map(a.attr("class").split(" "),function(a){return-1===a.indexOf(c)?a:s});a.attr("class",d.join(" "))})},generateColorText:function(a){return null==
a||0==a.alpha?"transparent":1==a.alpha?a.toHexString():a.toRgbString()}};t.string={random:function(a){for(var b="";0<a;--a)b+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.round(61*Math.random())];return b}};t.files={readableFileSize:function(a){var b=0;for(a=parseInt(a,10);1023<a;)b+=1,a/=1024;a=a.toFixed(2);switch(b){case 1:return a+" KB";case 2:return a+" MB";case 3:return a+" GB";case 4:return a+" PB";default:return a+" B"}}};t.array={removeItem:function(a,c){for(var f=
b.inArray(a,c);-1!=f;)c.splice(f,1),f=b.inArray(a,c);return c}};t.style={getNameAndColors:function(a,b){var f=a.templateGroups[b];return f?f:a.templateGroups["default"]},replaceCssTokens:function(a,b,f,d){return"string"!=typeof a?"":a.replace(/_-StyleClass-_/g,b).replace(/_-ThemeName-_/g,f).replace(/_-StyleAssetsClientRoot-_/g,d)},getImportUrlFromFont:function(a,c){var f=s;b.each(a,function(a,e){if(b.isPlainObject(e)&&e.name==c)return f=e.importUrl,!1});return f}};aa.StyleWizard=function(){x=0<arguments.length?
arguments[0]:[];b.extend(!0,void 0,x);F=b.extend(!0,{defaultFonts:[{name:"Arial"},{name:"Arial Black"},{name:"Verdana"},{name:"Times New Roman"},{name:"Avant Garde"},{name:"Georgia"},{name:"Courier New"},{name:"Impact"},{name:"Tahoma"},{name:"Comic Sans MS"},{name:"Lucida Console"}],backend:"",localization:{}},1<arguments.length?arguments[1]:{});ca||(ca=!0,D=b('<div id="EasyDNNstyleWizard"><div class="headerWrapper"><div class="logos"><a class="eds" target="_blank" href="http://www.easydnnsolutions.com/" title="EasyDNNSolutions.com">EasyDNNSolutions.com</a><a class="styleWizard" target="_blank" href="http://www.easydnnsolutions.com/modules/easydnnstylewizard/" title="EasyDNNSolutions StyleWizard">EasyDNNstyleWizard</a></div></div><div class="styleSubjectSelectionWrapper" style="display: none;"><select></select></div><div class="styleSubjectsWrapper" style="display: none;"></div><div class="introContainer standardScrollbar"><div class="viewport"><div class="overview"><div class="intro"></div></div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div><div class="footerWrapper"><div class="actions"><span class="action save">Save</span><select class="collectionSaveSelect"></select></div></div></div><ol id="EasyDNNstyleWizardCollections"></ol>').appendTo("body"),
H=b('<div id="EasyDNNstyleWizardToggle"><span></span>Show</div>').appendTo("body"),ha=b("> .headerWrapper",D),V=b("> .footerWrapper",D),J=b("> .styleSubjectSelectionWrapper",D),z=b("> .styleSubjectsWrapper",D),O=b("> .introContainer",D),A=b("#EasyDNNstyleWizardCollections"),P=b("> .actions > .collectionSaveSelect",V),R=D.outerWidth(),1<x.length&&P.append('<option value="all">All</option>').addClass("show"),b.each(x,function(a,c){var f=b('<li class="'+c.type+'"><span>'+c.name+"</span></li>"),d=c.type.charAt(0).toUpperCase()+
c.type.slice(1);"news"==c.type&&(d="EasyDNNnews");1<x.length&&P.append('<option value="'+c.type+'">'+d+"</option>");C.push(0);f.data("type",c.type);A.append(f)}),A.css({left:-A.outerHeight()}),A.on("click","> li",function(){var a=b(this).index();B!=a&&(B=a,p.openActiveCollection())}),O.tinyscrollbar(),p.resize(),ka.resize(function(){p.resize()}).scroll(function(){b.each(G,function(a,b){b.spectrum("reflow")})}),p.toggleInterface("visible"==b.cookie("edsStyleWizardInterfaceVisible"),!1),H.on("click",
function(){p.toggleInterface(U,!0);b.cookie("edsStyleWizardInterfaceVisible",U?"hidden":"visible",{path:"/"})}),b("> select",J).on("change",function(){C[B]=this.selectedIndex;p.openActiveSubject()}),b("> .actions > .save",V).on("click",function(){var a=P.hasClass("show")?P.val():"all",c,f=function(){var a;d&&0==N.length&&(a=b("p.mainMessage",c),e?a.addClass("error").text(k):a.addClass("success").text("All styles saved successfully"),b("> div",c).append('<div class="actions"><span>Ok</span></div>'))},
d=!1,e=!1,k="An error occured while saving",h=!1;0<N.length||(c=b('<div id="EasyDNNstyleWizardModalWrapper" class="save"><div><p class="mainMessage">Saving styles...</p></div></div>').appendTo("body").fadeTo(200,1).on("click","> div > .actions > span",function(){h||(h=!0,c.fadeTo(200,0,function(){c.remove()}))}),setTimeout(function(){d=!0;f()},1E3),b.each(x,function(c,d){if("all"==a||d.type==a)N.push(d.type),b.ajax({type:"post",data:{collection:d.type,action:"saveCollection",collectionJson:JSON.stringify(d)},
dataType:"json",success:function(a){a.success!=s&&a.success||(e=!0)},error:function(a){403==a.status&&(k="You don't have permission to make changes");e=!0},complete:function(){N.splice(N.indexOf(d.type),1);f()},timeout:15E3,url:F.backend})}))}),z.on("click","> div > .slider > .styleSelection .styleTypeSelection > li",function(){var a=b(this);a.hasClass("active")||(a.addClass("active").siblings().removeClass("active"),b(">",a.parent().siblings(".styleTypes")).css("display","none").eq(a.index()).css("display",
"block").find("li").removeClass("actionsOverlayActive"),a.parents(".slider > .styleSelection.standardScrollbar").tinyscrollbar_update("relative"))}).on("click","> div > .slider .styleTypes > div > ol > li > div > .standardOverlay, > div > .slider .styleTypes > div > ol > li > span",function(){var a=B,c=C[a],f=b(this),f="span"==this.tagName.toLowerCase()?f.parent():f.parents().eq(1),d=f.parents().eq(1).hasClass("predefined")?"predefined":"custom",e=f.data("styleId"),a=x[a],c=a.subjects[c],k,h,g="";
f.siblings().removeClass("actionsOverlayActive");if(c.activeStyle.type!=d||c.activeStyle.id!=e)c.activeStyle.type=d,c.activeStyle.id=e,k=a.styleGroups[c.styleGroup],h=k.styles[d][e],b("> div > ol > li",f.parents().eq(2)).removeClass("active"),f.addClass("active"),g="predefined"==d?h.baseCss:k.styles.predefined[h.originalStyleId].baseCss,"string"!=typeof g&&(g=""),m.changeSectionStyle({collectionType:a.type,styleSwitchCriteria:c.styleSwitchCriteria,styleGroup:c.styleGroup,globalFontFamilies:k.customFontFamilies,
template:c.template,templateGroup:c.templateGroup,themeName:k.themeName,assetsRootPath:k.styleAssetsClientRoot,style:{type:d,id:e,definition:k.styleDefinitions,values:h.values,baseCss:g}})}).on("click","> div > .slider .styleTypes > div > ol > li > div > .standardOverlay > .openActionsOverlay",function(){b(this).parents().eq(2).addClass("actionsOverlayActive");return!1}).on("click","> div > .slider .styleTypes > div > ol > li > div > .actionsOverlay > .action.close",function(){b(this).parents().eq(2).removeClass("actionsOverlayActive");
return!1}).on("click","> div > .slider .styleTypes .actionsOverlay > .action.delete",function(){var a=b(this).parents().eq(2),c=a.parents().eq(1).hasClass("predefined")?"predefined":"custom",f=a.data("styleId"),a=B,d=C[a],e=x[a],k=e.subjects[d],h=e.styleGroups[k.styleGroup],g,l,p,n,q,u=b("> .subject_"+a+"_"+d+" > > .styleSelection .styleTypes",z),r=u.siblings(".styleTypeSelection");updateMainWrapperPosition=function(){p.css("margin-top",-Math.ceil(p.height()/2))};styleUsageError=function(){p.addClass("show");
n.html('<p class="error">An error occurred while checking where the style is used.</p>');q.html('<span class="checkUsageAgain">Try again</span><span class="cancel">Cancel</span>');updateMainWrapperPosition()};deleteConfirmationDialog=function(a){n.html(a.dialogHtmlContent);q.html('<span class="deleteStyle">Confirm deletion</span><span class="cancel">Cancel</span>');p.addClass("show");updateMainWrapperPosition()};destroyOverlay=function(){g.stop(!0).fadeTo(200,0,function(){g.remove()})};getStyleUsage=
function(){b.ajax({data:{action:"getStyleUsage",styleType:c,styleId:f,themeName:h.themeName,collectionPortalId:h.portalId,collection:e.type},dataType:"json",success:function(a){a.success!=s&&a.success?deleteConfirmationDialog(a):styleUsageError()},error:function(){styleUsageError()},timeout:15E3,url:F.backend})};deleteStyle=function(){b.ajax({data:{action:"deleteStyle",styleId:f,themeName:h.themeName,collectionPortalId:h.portalId,collection:e.type},dataType:"json",success:function(a){var d="",g=!1;
a.success!=s&&a.success?(l.text("The style was successfully deleted").addClass("positive"),updateMainWrapperPosition(),k.activeStyle.type==c&&k.activeStyle.id==f&&(a=h.styles.predefined["default"],d="string"==typeof a.baseCss,"string"!=typeof d&&(d=""),k.activeStyle={type:"predefined",id:"default"},m.changeSectionStyle({collectionType:e.type,styleSwitchCriteria:k.styleSwitchCriteria,styleGroup:k.styleGroup,globalFontFamilies:h.customFontFamilies,template:k.template,templateGroup:k.templateGroup,themeName:h.themeName,
assetsRootPath:h.styleAssetsClientRoot,style:{type:"predefined",id:"default",definition:h.styleDefinitions,values:a.values,baseCss:d}}),"predefined"!=c&&(g=!0),b("> .predefined > ol > li.predefined_default",u).addClass("active")),d="custom"==c?"predefined":"custom",delete h.styles[c][f],b.isEmptyObject(h.styles[c])&&(delete h.styles[c],g=!0,b("> ."+c,r).css("display","none")),b("> ."+c+" > ol > li."+f,u).remove(),g&&(b("> ."+d,u).css("display","block"),b("> ."+c,u).css("display","none"),b(">",r).removeClass("active").filter("."+
d).addClass("active")),setTimeout(destroyOverlay,2E3)):styleDeletionError()},error:function(){styleDeletionError()},timeout:15E3,url:F.backend})};styleDeletionError=function(){n.html('<p class="error">An error occurred while deleting the style.</p>');q.html('<span class="deleteStyle">Try again</span><span class="cancel">Cancel</span>');p.addClass("show");updateMainWrapperPosition()};b("body").append('<div id="EasyDNNstyleWizardModalWrapper" class="deleteStyle"><div class="loading"></div><div class="main"><div class="content"></div><div class="actions"></div></div></div>');
g=b("#EasyDNNstyleWizardModalWrapper.deleteStyle");l=b("> .loading",g);l.text("Checking style usage...");p=b("> .main",g);n=b("> .content",p);q=b("> .actions",p);q.on("click","> span.cancel",function(){destroyOverlay()}).on("click","> span.checkUsageAgain",function(){p.removeClass("show");getStyleUsage()}).on("click","> span.deleteStyle",function(){p.removeClass("show");deleteStyle()});getStyleUsage()}).on("click","> div > .slider .styleTypes .actionsOverlay > .action.edit",function(){var a=b(this).parents(),
c=a.filter(".styleSubjectsWrapper > div > div"),f=a.eq(2),d=f.parents().eq(1).hasClass("predefined")?"predefined":"custom",e=f.data("styleId"),k=B,h=C[k],g=x[k],a=g.subjects[h],l=g.styleGroups[a.styleGroup].styles,m,n=b("> .subject_"+k+"_"+h+" > > .styleSelection .styleTypes",z),q;b("> > ol > li",n).removeClass("active actionsOverlayActive");"predefined"==d?(e=p.cloneStyle({collection:k,subject:h,type:d,id:e}),d="custom",b(">",n.siblings(".styleTypeSelection")).removeClass("active").css("display",
"").filter(".custom").addClass("active"),m=l[d][e],q=t.style.getNameAndColors(m,a.templateGroup),b(">",n).css("display","none").filter("."+d).css("display","block").find("> ol").append(p.generateStyleListItem({name:q.name,type:d,colors:q.colors,active:!0,id:e})),f=b('> div[class*=" subject_'+k+'_"], > div[class^="subject_'+k+'_"]',z),f.each(function(){var a=b(this),c=a.data("subjectIndex");c!=h&&(c=g.subjects[c],c==s||m.show&&-1==b.inArray(c.templateGroup,m.show)||(a=b("> > .styleSelection > .viewport > .overview",
a),b("> .styleTypeSelection > .custom",a).css("display",""),b("> .styleTypes > .custom > ol",a).append(p.generateStyleListItem({name:q.name,type:d,colors:q.colors,active:!1,id:e}))))}),b("> .styleSelection",c).tinyscrollbar_update("relative")):f.addClass("active");a.activeStyle.type=d;a.activeStyle.id=e;p.setupStyleEditor();b("> .styleEditor > .editor",c).tinyscrollbar_update("relative");c.animate({left:-S},200)}).on("click","> div > .slider > .styleEditor > .header > .back",function(){b(this).parents().eq(1);
b(this).parents().eq(2).stop(!0).animate({left:0},100)}).on("click","> div > .slider > .styleEditor .styleEditorSpacer .toggleContainer > div.name",function(){var a=b(this).parents(),c=a.eq(0).siblings(".toggleContent"),f=a.eq(1),d=a.filter(".styleEditor > .editor"),a=function(){d.tinyscrollbar_update("relative")},e=f.data("propertyInitializer");e&&(e(),f.data("propertyInitializer",!1));f.hasClass("expanded")?(f.removeClass("expanded"),c.slideUp(100,a)):(f.addClass("expanded"),c.slideDown(100,a));
return!1}).on("click","> div > .slider > .styleEditor .styleEditorSpacer ul.properties .toggleContent > ol > li",function(){var a=b(this);a.hasClass("active")||(a.addClass("active").siblings().removeClass("active"),b("> div",a.parent().siblings(".propertyStatesWrapper")).css("display","none").eq(a.index()).css("display",""),a.parents(".styleEditor > .editor").tinyscrollbar_update("relative"))}).on("change","> div > .slider > .styleEditor .styleEditorSpacer ul.properties .toggleContent .collapsableOptionsContainer > .trigger input",
function(){var a=b(this),c=a.parents().eq(2),f=b("> .contentWrapper",c),d=function(){a.parents(".styleEditor > .editor").tinyscrollbar_update("relative")};this.checked?(c.addClass("expanded"),f.stop(!0).slideDown(100,d)):(c.removeClass("expanded"),f.stop(!0).slideUp(100,d));a.parents(".styleEditor > .editor").tinyscrollbar_update("relative")}).on("change","> div > .slider > .styleEditor > .header > .styleName input",function(){var a=b(this),c=B,f=x[c],c=f.subjects[C[c]],f=f.styleGroups[c.styleGroup].styles[c.activeStyle.type][c.activeStyle.id],
d=f.templateGroups[c.templateGroup]?c.templateGroup:"default",a=b("> .styleSelection .styleTypes > .custom > ol > li."+c.activeStyle.id+" > span",a.parents().eq(4)).text(a.val()).html();f.templateGroups[d].name=a}))}})(eds1_10,window,document);